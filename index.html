<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel Ejecutivo ‚Äî Direcci√≥n General</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg:       #293636; /*eef0f0*/
  --surf:     #2E2E3B; /*ffffff*/
  --surf2:    #2E2E3B; /*f4f6f7*/
  --surf3:    #95979E; /*e8ecec*/
  --brd:      #d0d8d8;
  --brd2:     #c2c8c5;

  --dark:     #373F4D;   /* azul petr√≥leo oscuro */
  --mid:      #2E2E3B;   /* azul petr√≥leo medio */
  --light:    #AAB3B3;   /* azul petr√≥leo claro */
  --pale:     #C2C8C5;   /* gris azulado */
  --cream:    #DDDDDA;   /* gris claro */

  --obra:     #4A707A;
  --obra-g:   rgba(74,112,122,0.1);
  --obra-gb:  rgba(74,112,122,0.18);
  --prov:     #7697A0;
  --prov-g:   rgba(118,151,160,0.1);
  --prov-gb:  rgba(118,151,160,0.18);

  --txt:      #DFE8ED;
  --txt2:     #DFECF0;
  --txt3:     #94B0B7;
  --txt4:     #b8c4c6;

  --red:      #c0505a;
  --green:    #3d8a70;
  --yellow:   #b8903a;
  --purple:   #6a5a98;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RESPONSIVE BASE ‚Äî fluid spacing via clamp()
   clamp(MIN, PREFERRED, MAX)
   px usados solo para bordes/sombras fijas
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

* { margin:0; padding:0; box-sizing:border-box; }
html { font-size:clamp(13px, 1.2vw, 16px); }
body { font-family:'DM Sans',sans-serif; background:var(--dark); color:var(--txt); min-height:100vh; overflow-x:hidden; }

body::before {
  content:''; position:fixed; inset:0;
  background-image:
    linear-gradient(rgba(74,112,122,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(74,112,122,0.03) 1px, transparent 1px);
  background-size:clamp(20px,3vw,36px) clamp(20px,3vw,36px);
  pointer-events:none; z-index:0;
}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
header {
  position:sticky; top:0; z-index:100;
  background:var(--dark);
  border-bottom:3px solid var(--dark);
  padding:0 clamp(12px, 3vw, 44px);
  display:flex; align-items:stretch; justify-content:space-between;
  box-shadow:0 4px 24px rgba(74,112,122,0.25);
}
.header-left { display:flex; align-items:center; gap:clamp(10px,1.5vw,18px); padding:clamp(12px,1.8vw,22px) 0; }
.logo-mark {
  width:clamp(32px,4vw,48px); height:clamp(32px,4vw,48px);
  border:2px solid rgba(255,255,255,0.25);
  background:rgba(255,255,255,0.1);
  display:flex; align-items:center; justify-content:center;
  font-size:clamp(14px,2vw,24px); flex-shrink:0;
}
.header-org {
  font-size:clamp(8px,0.7vw,11px); letter-spacing:0.2em; text-transform:uppercase;
  color:rgba(255,255,255,0.55); font-family:'DM Mono',monospace; margin-bottom:4px;
}
.header-title {
  font-family:'Playfair Display', serif;
  font-size:clamp(16px,2.5vw,32px); font-weight:900;
  color:#ffffff; line-height:1; letter-spacing:-0.01em;
}
.header-right {
  display:flex; align-items:center; gap:clamp(12px,2vw,28px);
  border-left:1px solid rgba(255,255,255,0.12);
  padding-left:clamp(12px,2vw,28px); margin:clamp(8px,1.2vw,16px) 0;
}
.header-date {
  text-align:right; font-family:'DM Mono',monospace;
  font-size:clamp(9px,0.75vw,11px); color:rgba(255,255,255,0.5);
  letter-spacing:0.08em; line-height:1.7;
}
.header-badge {
  padding:clamp(5px,0.6vw,8px) clamp(10px,1.4vw,20px);
  background:rgba(255,255,255,0.12);
  border:1px solid rgba(255,255,255,0.2);
  font-size:clamp(10px,0.85vw,12px); font-weight:500;
  color:rgba(255,255,255,0.85); letter-spacing:0.06em;
  white-space:nowrap;
}

/* ‚îÄ‚îÄ KPI BAR ‚îÄ‚îÄ */
.kpi-bar {
  display:grid; grid-template-columns:repeat(5,1fr);
  gap:1px; background:var(--brd);
  border:1px solid var(--dark);
  margin:clamp(12px,2vw,28px) clamp(12px,3vw,44px) 0;
  position:relative; z-index:5;
  animation:fu .5s ease both;
  box-shadow:0 2px 12px rgba(74,112,122,0.08);
}
.kpi {
  background:var(--surf); padding:clamp(12px,1.8vw,24px) clamp(12px,1.8vw,26px);
  position:relative; overflow:hidden;
  transition:background .2s; cursor:default;
}
.kpi:hover { background:var(--surf2); }
.kpi::after { content:''; position:absolute; top:0; left:0; right:0; height:3px; }
.kpi.ko::after { background:var(--txt3); }
.kpi.kp::after { background:var(--txt3); }
.kpi.kt::after { background:linear-gradient(90deg,var(--obra),var(--prov)); }
.kpi-lbl {
  font-size:clamp(8px,0.65vw,10px); letter-spacing:0.18em; text-transform:uppercase;
  color:var(--txt3); font-family:'DM Mono',monospace; margin-bottom:clamp(4px,0.7vw,10px);
}
.kpi-val {
  font-family:'Playfair Display',serif;
  font-size:clamp(18px,2.8vw,38px); font-weight:700; line-height:1;
}
.ko .kpi-val { color:var(--obra); }
.kp .kpi-val { color:var(--prov); }
.kt .kpi-val { color:var(--txt); }
.kpi-sub { font-size:clamp(9px,0.8vw,12px); color:var(--txt3); margin-top:clamp(3px,0.4vw,6px); }

/* ‚îÄ‚îÄ MAIN GRID ‚îÄ‚îÄ */
.main {
  display:grid; grid-template-columns:1fr;
  gap:clamp(12px,1.5vw,22px); padding:clamp(12px,1.8vw,24px) clamp(12px,3vw,44px) 0;
  position:relative; z-index:5;
}

/* ‚îÄ‚îÄ PANEL ‚îÄ‚îÄ */
.panel {
  background:var(--surf); overflow:hidden;
  box-shadow:0 2px 12px rgba(74,112,122,0.06);
  animation:fu .5s ease both;
}
.panel:nth-child(1){animation-delay:.1s;}
.panel:nth-child(2){animation-delay:.2s;}

.p-head {
  padding:clamp(10px,1.4vw,20px) clamp(12px,1.8vw,26px);
  border-bottom:1px solid var(--brd);
  display:flex; align-items:center; justify-content:space-between;
  position:relative; overflow:hidden;
}
.p-head::before { content:''; position:absolute; inset:0; opacity:.04; }
.po .p-head { background:linear-gradient(135deg, rgba(74,112,122,0.08), transparent); }
.pp .p-head { background:linear-gradient(135deg, rgba(118,151,160,0.08), transparent); }
.p-head-l { display:flex; align-items:center; gap:clamp(8px,1vw,14px); position:relative; z-index:1; }
.p-icon {
  width:clamp(28px,3vw,42px); height:clamp(28px,3vw,42px);
  display:flex; align-items:center; justify-content:center;
  font-size:clamp(12px,1.4vw,18px); border:1px solid; flex-shrink:0;
}
.po .p-icon { border-color:rgba(74,112,122,0.35); color:var(--obra); background:var(--obra-g); }
.pp .p-icon { border-color:rgba(118,151,160,0.35); color:var(--prov); background:var(--prov-g); }
.p-title { font-family:'Playfair Display',serif; font-size:clamp(14px,1.5vw,20px); font-weight:700; color:var(--txt); }
.p-count { font-family:'DM Mono',monospace; font-size:clamp(9px,0.75vw,11px); color:var(--txt3); margin-top:3px; }

/* ‚îÄ‚îÄ TOOLBAR ‚îÄ‚îÄ */
.toolbar {
  padding:clamp(8px,0.8vw,11px) clamp(12px,1.8vw,26px);
  border-bottom:1px solid var(--brd);
  display:flex; gap:clamp(6px,0.6vw,8px); align-items:center;
  background:var(--surf2); flex-wrap:wrap;
}
.srch {
  flex:1; min-width:0; background:var(--surf); border:1px solid var(--brd2);
  padding:clamp(5px,0.5vw,7px) clamp(8px,1vw,13px);
  font-family:'DM Sans',sans-serif; font-size:clamp(11px,1vw,13px);
  color:var(--txt); outline:none; transition:border-color .2s;
}
.srch:focus { border-color:var(--mid); }
.srch::placeholder { color:var(--txt4); }
.ftag {
  padding:clamp(4px,0.4vw,5px) clamp(8px,0.9vw,12px);
  font-size:clamp(9px,0.8vw,11px); letter-spacing:0.05em;
  border:1px solid var(--brd); cursor:pointer; transition:all .15s;
  color:var(--txt3); font-family:'DM Mono',monospace;
  white-space:nowrap; background:var(--surf);
}
.ftag:hover { color:var(--txt2); border-color:var(--mid); }
.ftag.ao { border-color:var(--obra); color:var(--obra); background:var(--obra-g); font-weight:600; }
.ftag.ap { border-color:var(--prov); color:var(--prov); background:var(--prov-g); font-weight:600; }

/* ‚îÄ‚îÄ STATE GROUP ‚îÄ‚îÄ */
.state-group { border-bottom:1px solid var(--dark); overflow:hidden; }
.state-group:last-child { border-bottom:none; }
.sg-head {
  padding:clamp(8px,1vw,14px) clamp(12px,1.8vw,26px);
  display:flex; align-items:center; justify-content:space-between;
  cursor:pointer; transition:background .15s; background:var(--surf2);
  border-bottom:1px solid var(--dark); gap:8px;
}
.sg-head:hover { background:var(--surf3); }
.sg-head-l { display:flex; align-items:center; gap:clamp(6px,0.8vw,12px); flex-wrap:wrap; min-width:0; flex:1; }
.sg-chevron { font-size:11px; color:var(--txt3); transition:transform .25s; display:inline-block; width:14px; flex-shrink:0; }
.sg-chevron.open { transform:rotate(90deg); }
.sg-estado { font-size:clamp(12px,1.1vw,15px); font-weight:700; color:var(--txt3); letter-spacing:0.02em; }
.sg-badge {
  padding:2px clamp(6px,0.7vw,10px); font-size:clamp(8px,0.68vw,10px);
  font-family:'DM Mono',monospace; border:1px solid; font-weight:600;
}
.sg-badge.o { border-color:rgba(74,112,122,.4); color:var(--obra); background:var(--obra-g); }
.sg-badge.p { border-color:rgba(118,151,160,.4); color:var(--prov); background:var(--prov-g); }
.sg-stats { display:flex; gap:clamp(10px,1.6vw,24px); flex-shrink:0; }
.sg-stat { text-align:right; }
.sg-stat-lbl { font-size:clamp(7px,0.6vw,9px); color:var(--txt3); font-family:'DM Mono',monospace; letter-spacing:.12em; text-transform:uppercase; }
.sg-stat-val { font-size:clamp(10px,0.9vw,13px); font-weight:700; font-family:'DM Mono',monospace; }
.sg-stat-val.o { color:var(--txt3); }
.sg-stat-val.p { color:var(--txt3); }
.sg-body { display:none; }
.sg-body.open { display:block; }

/* ‚îÄ‚îÄ MUNICIPIO GROUP ‚îÄ‚îÄ */
.mun-group { border-top:1px solid var(--brd); }
.mg-head {
  padding:clamp(7px,0.7vw,10px) clamp(12px,1.8vw,26px) clamp(7px,0.7vw,10px) clamp(20px,3vw,44px);
  display:flex; align-items:center; justify-content:space-between;
  cursor:pointer; background:rgba(74,112,122,0.03); transition:background .15s;
}
.mg-head:hover { background:rgba(74,112,122,0.07); }
.mg-left { display:flex; align-items:center; gap:8px; }
.mg-chevron { font-size:9px; color:var(--txt4); transition:transform .2s; }
.mg-chevron.open { transform:rotate(90deg); }
.mg-name { font-size:clamp(11px,0.95vw,13px); font-weight:600; color:var(--txt3); }
.mg-count { font-size:clamp(9px,0.8vw,11px); color:var(--txt3); font-family:'DM Mono',monospace; }
.mg-body { display:none; }
.mg-body.open { display:block; }

/* ‚îÄ‚îÄ TABLE HEAD ‚îÄ‚îÄ */
.t-head {
  display:grid; grid-template-columns:clamp(44px,5vw,62px) 1fr clamp(70px,8vw,104px) clamp(70px,8vw,100px) clamp(44px,5vw,68px);
  padding:7px clamp(12px,1.8vw,26px) 7px clamp(24px,4vw,60px);
  background:rgba(74,112,122,0.05);
  font-size:clamp(8px,0.65vw,10px); letter-spacing:.14em; text-transform:uppercase;
  color:var(--txt3); font-family:'DM Mono',monospace;
  border-top:1px solid var(--dark);
}

/* ‚îÄ‚îÄ PROJECT ROW ‚îÄ‚îÄ */
.p-row {
  display:grid; grid-template-columns:clamp(44px,5vw,62px) 1fr clamp(70px,8vw,104px) clamp(70px,8vw,100px) clamp(44px,5vw,68px);
  padding:clamp(8px,0.9vw,12px) clamp(12px,1.8vw,26px) clamp(8px,0.9vw,12px) clamp(24px,4vw,60px);
  border-top:1px solid var(--dark);
  cursor:pointer; transition:background .12s;
  position:relative; align-items:center;
}
.p-row::before { content:''; position:absolute; left:0; top:0; bottom:0; width:0; transition:width .2s; }
.p-row.ro::before { background:var(--obra); }
.p-row.rp::before { background:var(--prov); }
.p-row:hover::before { width:4px; }
.p-row:hover { background:rgba(74,112,122,0.04); }

.c-id { font-family:'DM Mono',monospace; font-size:clamp(9px,0.78vw,11px); color:var(--txt4); letter-spacing:.06em; }
.c-name { font-size:clamp(11px,0.95vw,13px); font-weight:500; color:var(--txt); line-height:1.3; padding-right:8px; }
.c-name .sub { font-size:clamp(9px,0.78vw,11px); color:var(--txt3); margin-top:2px; font-weight:400; }
.c-amt { font-family:'DM Mono',monospace; font-size:clamp(10px,0.85vw,12px); text-align:right; font-weight:600; }
.ro .c-amt { color:var(--obra); }
.rp .c-amt { color:var(--prov); }
.c-av { text-align:right; }
.av-n { font-family:'DM Mono',monospace; font-size:clamp(10px,0.85vw,12px); margin-bottom:4px; font-weight:600; }
.pb { width:100%; height:4px; background:var(--brd); overflow:hidden; }
.pf { height:100%; transition:width .9s ease; }
.ro .pf { background:var(--obra); }
.rp .pf { background:var(--prov); }
.pf.over { background:var(--red); }
.c-tp { font-size:clamp(8px,0.68vw,10px); color:var(--txt3); font-family:'DM Mono',monospace; letter-spacing:.04em; text-align:right; }

/* ‚îÄ‚îÄ PANEL FOOTER ‚îÄ‚îÄ */
.p-foot {
  padding:clamp(8px,1vw,13px) clamp(12px,1.8vw,26px);
  border-top:2px solid var(--brd);
  display:flex; align-items:center; justify-content:space-between;
  background:var(--surf2);
}
.f-stat { font-size:clamp(10px,0.85vw,12px); color:var(--txt3); font-family:'DM Mono',monospace; }
.f-stat span { font-size:clamp(11px,0.95vw,14px); font-weight:700; }
.po .f-stat span { color:var(--obra); }
.pp .f-stat span { color:var(--prov); }
.f-cnt { font-size:clamp(9px,0.78vw,11px); color:var(--txt3); font-family:'DM Mono',monospace; }

/* ‚îÄ‚îÄ BOTTOM ROW ‚îÄ‚îÄ */
.bottom {
  display:grid; grid-template-columns:1fr 1fr;
  gap:clamp(12px,1.5vw,22px); padding:clamp(12px,1.5vw,22px) clamp(12px,3vw,44px) clamp(24px,4vw,60px);
  position:relative; z-index:5;
}
.b-panel {
  border:1px solid var(--brd); background:var(--surf);
  box-shadow:0 2px 12px rgba(74,112,122,0.06);
  animation:fu .5s ease both;
}
.b-panel:nth-child(1){animation-delay:.3s;}
.b-panel:nth-child(2){animation-delay:.4s;}
.b-ph {
  padding:clamp(10px,1.3vw,18px) clamp(12px,1.5vw,22px);
  border-bottom:1px solid var(--brd);
  font-family:'Playfair Display',serif; font-size:clamp(13px,1.2vw,17px); font-weight:700;
  color:var(--dark);
  background:linear-gradient(135deg, rgba(74,112,122,0.05), transparent);
}

/* State chart */
.s-row { display:flex; align-items:center; gap:clamp(8px,1vw,12px); padding:clamp(7px,0.8vw,11px) clamp(12px,1.5vw,22px); border-bottom:1px solid var(--brd); }
.s-row:last-child { border:none; }
.s-name { min-width:clamp(80px,9vw,130px); font-size:clamp(11px,0.9vw,13px); font-weight:600; color:var(--dark); }
.s-bars { flex:1; display:flex; flex-direction:column; gap:4px; }
.s-bw { height:5px; background:var(--brd); }
.s-bf-o { background:var(--obra); height:100%; }
.s-bf-p { background:var(--prov); height:100%; }
.s-cnt { font-family:'DM Mono',monospace; font-size:clamp(9px,0.78vw,11px); color:var(--txt3); white-space:nowrap; font-weight:500; }
.s-leg { display:flex; gap:clamp(10px,1.2vw,16px); padding:clamp(8px,1vw,12px) clamp(12px,1.5vw,22px); border-top:1px solid var(--brd); background:var(--surf2); }
.s-li { display:flex; align-items:center; gap:7px; font-size:clamp(10px,0.85vw,12px); color:var(--txt2); font-family:'DM Mono',monospace; }
.s-dot { width:10px; height:10px; }

/* Avance distribution */
.av-grid { display:grid; grid-template-columns:1fr 1fr; gap:1px; background:var(--brd); }
.av-cell { background:var(--surf); padding:clamp(10px,1.2vw,16px) clamp(12px,1.3vw,18px); }
.av-ct { font-size:clamp(8px,0.68vw,10px); letter-spacing:.14em; text-transform:uppercase; color:var(--txt3); font-family:'DM Mono',monospace; margin-bottom:10px; }
.av-segs { display:flex; height:10px; gap:1px; margin-bottom:10px; overflow:hidden; }
.seg { height:100%; }
.av-leg { display:flex; flex-wrap:wrap; gap:8px; }
.al { display:flex; align-items:center; gap:5px; font-size:clamp(9px,0.78vw,11px); color:var(--txt2); }
.ad { width:8px; height:8px; flex-shrink:0; }
.av-stats {
  display:grid; grid-template-columns:repeat(4,1fr);
  gap:1px; background:var(--brd); border-top:1px solid var(--brd);
}
.av-s { background:var(--surf); padding:clamp(8px,1vw,14px) clamp(8px,1.1vw,16px); text-align:center; }
.av-sv { font-family:'Playfair Display',serif; font-size:clamp(16px,1.8vw,24px); font-weight:700; }
.av-sl { font-size:clamp(7px,0.6vw,10px); color:var(--txt3); letter-spacing:.1em; text-transform:uppercase; margin-top:3px; font-family:'DM Mono',monospace; }

/* ‚îÄ‚îÄ SIDE PANEL ‚îÄ‚îÄ */
.modal-ov {
  position:fixed; top:0; right:0; bottom:0;
  width:clamp(280px, 35vw, 460px); z-index:999;
  pointer-events:none;
  transform:translateX(100%);
  transition:transform .3s cubic-bezier(.4,0,.2,1);
}
.modal-ov.open { pointer-events:all; transform:translateX(0); }
.modal {
  background:var(--surf); border-left:2px solid var(--brd);
  width:100%; height:100%; overflow-y:auto;
  box-shadow:-8px 0 40px rgba(30,46,50,0.35);
  display:flex; flex-direction:column;
}
.m-head {
  padding:clamp(14px,1.5vw,22px) clamp(14px,1.8vw,26px);
  border-bottom:2px solid var(--brd);
  display:flex; justify-content:space-between; align-items:flex-start;
  background:linear-gradient(135deg, rgba(74,112,122,0.06), transparent);
  gap:12px;
}
.m-title { font-family:'Playfair Display',serif; font-size:clamp(14px,1.3vw,18px); font-weight:700; line-height:1.3; color:var(--txt2); }
.m-meta { font-family:'DM Mono',monospace; font-size:clamp(9px,0.78vw,11px); color:var(--txt3); margin-top:4px; }
.m-close { background:none; border:1px solid var(--brd); color:var(--txt3); font-size:clamp(13px,1.1vw,16px); cursor:pointer; padding:4px 10px; transition:all .15s; flex-shrink:0; }
.m-close:hover { border-color:var(--mid); color:var(--dark); }
.m-body { padding:clamp(14px,1.5vw,22px) clamp(14px,1.8vw,26px); }
.d-grid { display:grid; grid-template-columns:1fr 1fr; gap:clamp(10px,1.2vw,16px); margin-bottom:clamp(12px,1.4vw,20px); }
.d-item label { font-size:clamp(8px,0.68vw,10px); letter-spacing:.15em; text-transform:uppercase; color:var(--txt3); font-family:'DM Mono',monospace; display:block; margin-bottom:4px; }
.d-item value { font-size:clamp(12px,1vw,14px); color:var(--txt); font-weight:500; display:block; }
.d-sec { font-size:clamp(8px,0.68vw,10px); letter-spacing:.15em; text-transform:uppercase; color:var(--txt3); font-family:'DM Mono',monospace; border-bottom:2px solid var(--brd); padding-bottom:8px; margin-bottom:14px; margin-top:4px; }
.b-row { display:flex; justify-content:space-between; align-items:center; padding:clamp(7px,0.7vw,10px) 0; border-bottom:1px solid var(--brd); font-size:clamp(11px,0.9vw,13px); gap:8px; }
.b-row:last-child { border:none; }
.bl { color:var(--txt2); font-weight:400; }
.bv { font-family:'DM Mono',monospace; font-weight:700; font-size:clamp(11px,0.95vw,14px); }
.neg { color:var(--red); }
.pos { color:var(--green); }

@keyframes fu { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }

/* ‚ïê‚ïê TABLET (‚â§900px) ‚ïê‚ïê */
@media(max-width:900px){
  .kpi-bar { grid-template-columns:repeat(3,1fr); }
  .bottom { grid-template-columns:1fr; }
  .modal-ov { width:85vw; }
  .sg-stats { display:none; }
}

/* ‚ïê‚ïê M√ìVIL (‚â§600px) ‚ïê‚ïê */
@media(max-width:600px){
  html { font-size:14px; }

  header {
    padding:0 4vw;
    flex-wrap:wrap;
    gap:0;
  }
  .header-left { gap:10px; padding:12px 0; }
  .header-title { font-size:20px; }
  .header-org { font-size:9px; }
  .header-right {
    border-left:none; border-top:1px solid rgba(255,255,255,0.12);
    padding-left:0; padding-top:8px; margin:0 0 10px;
    width:100%; justify-content:space-between;
  }
  .logo-mark { width:34px; height:34px; font-size:16px; }

  .kpi-bar {
    grid-template-columns:repeat(2,1fr);
    margin:10px 4vw 0;
  }
  .kpi { padding:12px 14px; }
  .kpi-val { font-size:22px; }
  .kpi-lbl { font-size:8px; }
  .kpi-sub { font-size:10px; }

  .main, .bottom {
    padding:10px 4vw 0;
    gap:12px;
  }
  .bottom { padding-bottom:24px; }

  /* Tabla en m√≥vil: ocultar monto y tipo, compactar */
  .t-head,
  .p-row {
    grid-template-columns:clamp(38px,10vw,52px) 1fr clamp(60px,18vw,80px);
  }
  /* Ocultar columnas MONTO y TIPO */
  .t-head > div:nth-child(3),
  .t-head > div:nth-child(5),
  .p-row .c-amt,
  .p-row .c-tp { display:none; }

  .p-row { padding:10px 4vw 10px 8vw; }
  .t-head { padding:6px 4vw 6px 8vw; }
  .mg-head { padding:8px 4vw 8px 8vw; }

  .sg-head { padding:10px 4vw; flex-wrap:wrap; gap:6px; }
  .sg-badge { display:none; }
  .sg-stats { display:none; }

  .p-head { padding:12px 4vw; }
  .p-title { font-size:15px; }
  .toolbar { padding:8px 4vw; }
  .p-foot { padding:10px 4vw; }

  .av-grid { grid-template-columns:1fr; }
  .av-stats { grid-template-columns:repeat(2,1fr); }

  .modal-ov { width:100%; }
  .m-head { padding:14px 4vw; }
  .m-body { padding:14px 4vw; }
  .d-grid { grid-template-columns:1fr; }

  .b-ph { font-size:14px; padding:12px 14px; }
  .s-name { min-width:80px; font-size:11px; }
}
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="header-left">
    <div class="logo-mark">üèõ</div>
    <div class="header-text">
      <div class="header-org">Sistema de Gesti√≥n de Proyectos</div>
      <div class="header-title">Direcci√≥n General</div>
    </div>
  </div>
  <div class="header-right">
    <div class="header-date" id="live-date"></div>
    <div class="header-badge">Director General</div>
  </div>
</header>

<!-- KPIs -->
<div class="kpi-bar">
  <div class="kpi kt">
    <div class="kpi-lbl">Total Proyectos</div>
    <div class="kpi-val" id="k-tot">65</div>
    <div class="kpi-sub">Obra + Proveedur√≠a</div>
  </div>
  <div class="kpi ko">
    <div class="kpi-lbl">Proyectos de Obra</div>
    <div class="kpi-val">29</div>
    <div class="kpi-sub">6 estados</div>
  </div>
  <div class="kpi kp">
    <div class="kpi-lbl">Proyectos de Proveedur√≠a</div>
    <div class="kpi-val">36</div>
    <div class="kpi-sub">7 estados</div>
  </div>
  <div class="kpi ko">
    <div class="kpi-lbl">Presupuesto Obra</div>
    <div class="kpi-val" id="k-pob">‚Äî</div>
    <div class="kpi-sub" id="k-pob-s">‚Äî</div>
  </div>
  <div class="kpi kp">
    <div class="kpi-lbl">Presupuesto Proveedur√≠a</div>
    <div class="kpi-val" id="k-ppv">‚Äî</div>
    <div class="kpi-sub" id="k-ppv-s">‚Äî</div>
  </div>
</div>

<!-- MAIN PANELS -->
<div class="main">

  <!-- OBRAS -->
  <div class="panel po">
    <div class="p-head">
      <div class="p-head-l">
        <div class="p-icon">üèó</div>
        <div>
          <div class="p-title">Proyectos de Obra</div>
          <div class="p-count" id="ob-lbl">29 proyectos ¬∑ 6 estados</div>
        </div>
      </div>
    </div>
    <div class="toolbar">
      <input class="srch" id="srch-ob" placeholder="Buscar proyecto, municipio, contratista‚Ä¶" oninput="renderObras()">
      <select class="ftag ao" id="sel-ob" onchange="renderObras()" style="padding:5px 10px;font-size:11px;">
        <option value="">Todos los estados</option>
      </select>
    </div>
    <div id="ob-groups" style="max-height:480px;overflow-y:auto;"></div>
    <div class="p-foot">
      <div class="f-stat">Ejercido total: <span id="ob-ej">‚Äî</span></div>
      <div class="f-cnt" id="ob-cnt"></div>
    </div>
  </div>

  <!-- PROVEEDUR√çA -->
  <div class="panel pp">
    <div class="p-head">
      <div class="p-head-l">
        <div class="p-icon">üì¶</div>
        <div>
          <div class="p-title">Proyectos de Proveedur√≠a</div>
          <div class="p-count" id="pv-lbl">36 suministros ¬∑ 7 estados</div>
        </div>
      </div>
    </div>
    <div class="toolbar">
      <input class="srch" id="srch-pv" placeholder="Buscar suministro, municipio, proveedor‚Ä¶" oninput="renderProv()">
      <select class="ftag ap" id="sel-pv" onchange="renderProv()" style="padding:5px 10px;font-size:11px;">
        <option value="">Todos los estados</option>
      </select>
    </div>
    <div id="pv-groups" style="max-height:480px;overflow-y:auto;"></div>
    <div class="p-foot">
      <div class="f-stat">Ejercido suministro: <span id="pv-ej">‚Äî</span></div>
      <div class="f-cnt" id="pv-cnt"></div>
    </div>
  </div>

</div>

<!-- BOTTOM ANALYTICS -->
<div class="bottom">

  <div class="b-panel">
    <div class="b-ph">Distribuci√≥n por Estado</div>
    <div id="s-list"></div>
    <div class="s-leg">
      <div class="s-li"><div class="s-dot" style="background:var(--obra)"></div>Obra</div>
      <div class="s-li"><div class="s-dot" style="background:var(--prov)"></div>Proveedur√≠a</div>
    </div>
  </div>

  <div class="b-panel">
    <div class="b-ph">Distribuci√≥n de Avance Financiero</div>
    <div class="av-grid">
      <div class="av-cell">
        <div class="av-ct">Obras ‚Äî avance financiero</div>
        <div class="av-segs" id="seg-ob"></div>
        <div class="av-leg" id="leg-ob"></div>
      </div>
      <div class="av-cell">
        <div class="av-ct">Proveedur√≠a ‚Äî avance ejecutado</div>
        <div class="av-segs" id="seg-pv"></div>
        <div class="av-leg" id="leg-pv"></div>
      </div>
    </div>
    <div class="av-stats" id="av-stats"></div>
  </div>

</div>

<!-- SIDE PANEL -->
<div class="modal-ov" id="mov">
  <div class="modal">
    <div class="m-head">
      <div>
        <div class="m-title" id="mt"></div>
        <div class="m-meta" id="mc"></div>
      </div>
      <button class="m-close" onclick="cm()">‚úï</button>
    </div>
    <div class="m-body" id="mb"></div>
  </div>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DATA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const OBRAS=[{clave:"P-0001",proyecto:"OBRA ELECTRICA AVENIDA 10 NORTE",estado:"QUINTANA ROO",municipio:"PLAYA DEL CARMEN",inicio:"20/10/2025",termino:"‚Äî",tipo_ejecucion:"CONTRATISTA",razon_social:"",num_contrato:"",monto:3871546.95,presupuesto:2138806.14,avance_fisico:99,avance_financiero:100,ejercido:2139731.89,disponible:-925.75},{clave:"P-0010",proyecto:"CANCHA PUBLICA, TEJERIA",estado:"TABASCO",municipio:"TEAPA",inicio:"29/08/2025",termino:"11/11/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"TEA-DOOTSM-AD21/2025",monto:2876074.74,presupuesto:1521616.72,avance_fisico:95,avance_financiero:99,ejercido:1511408.14,disponible:10208.58},{clave:"P-0011",proyecto:"PAV. PEDRO COLORADO CENTLA",estado:"TABASCO",municipio:"CENTLA",inicio:"03/09/2025",termino:"06/11/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"MATERIALES GONIA SA DE CV",num_contrato:"CO-DOOTSM-33-030-230-08-K003/2025",monto:9303329.73,presupuesto:6283798.68,avance_fisico:100,avance_financiero:96,ejercido:6022782.8,disponible:261015.88},{clave:"P-0013",proyecto:"XOCHIMILCO",estado:"CDMX",municipio:"CDMX",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"KUKULKAN ENERGY SA DE CV",num_contrato:"",monto:0,presupuesto:0,avance_fisico:100,avance_financiero:0,ejercido:0,disponible:0},{clave:"P-0016",proyecto:"MUROS DE CONTENCION, PICHUCALCO",estado:"CHIAPAS",municipio:"PICHUCALCO",inicio:"15/08/2025",termino:"15/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"",num_contrato:"MPC/COP/068//FOGIRD/12¬™.EXT.VI.IV-001/2025",monto:3499020.35,presupuesto:1917577.64,avance_fisico:100,avance_financiero:86,ejercido:1647003.12,disponible:270574.52},{clave:"P-0019",proyecto:"BACHEO EN CABECERA MUNICIPAL, PICHUCALCO",estado:"CHIAPAS",municipio:"PICHUCALCO",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"",monto:3192624.21,presupuesto:1748102.68,avance_fisico:90,avance_financiero:34,ejercido:590681.58,disponible:1157421.1},{clave:"P-0020",proyecto:"TEAPA DRENAJE PLUVIAL RIO TULIJ√Å",estado:"TABASCO",municipio:"TEAPA",inicio:"31/10/2025",termino:"14/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"TEA-CONT-DOOTSM-036-AD36/2025",monto:876986.98,presupuesto:585545.9,avance_fisico:95,avance_financiero:83,ejercido:484857.78,disponible:100688.12},{clave:"P-0021",proyecto:"TEAPA DRENAJE SANITARIO RIO TULIJ√Å",estado:"TABASCO",municipio:"TEAPA",inicio:"31/10/2025",termino:"14/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"TEA-CONT-DOOTSM-035-AD35/2025",monto:678795.49,presupuesto:455181.06,avance_fisico:95,avance_financiero:90,ejercido:411587.31,disponible:43593.75},{clave:"P-0024",proyecto:"GUARNICIONES Y BANQUETAS RIO TULIJ√Å",estado:"TABASCO",municipio:"TEAPA",inicio:"12/11/2025",termino:"26/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"TEA-CONT-DOOTSM-043-AD43/2025",monto:463416.98,presupuesto:285481.31,avance_fisico:95,avance_financiero:100,ejercido:284482.15,disponible:999.16},{clave:"P-0025",proyecto:"PAVIMENTO CONCRETO RIO TULIJ√Å",estado:"TABASCO",municipio:"TEAPA",inicio:"12/11/2025",termino:"26/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"EA-CONT-DOOTSM-044-AD44/2025",monto:1660622.59,presupuesto:1034333.72,avance_fisico:83,avance_financiero:95,ejercido:985608.83,disponible:48724.89},{clave:"P-0023",proyecto:"MERIDA 4 COL. EMILIANO ZAPATA CONT. 168",estado:"YUCATAN",municipio:"MERIDA",inicio:"24/11/2025",termino:"25/12/2025",tipo_ejecucion:"CONTRATISTA",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"VT25-FICON-6152-168",monto:4099650.28,presupuesto:2757783.77,avance_fisico:100,avance_financiero:101,ejercido:2795422.05,disponible:-37638.28},{clave:"P-0133",proyecto:"MERIDA 5 REPAV CONTRATO 267",estado:"YUCATAN",municipio:"MERIDA",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"CONTRATISTA",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"VT25-FPCON-6152-267",monto:3769722.18,presupuesto:2525500,avance_fisico:15,avance_financiero:41,ejercido:1025429.64,disponible:1500070.36},{clave:"P-0026",proyecto:"REHABILITACION DE TANQUE PICHUCALCO",estado:"CHIAPAS",municipio:"PICHUCALCO",inicio:"21/10/2025",termino:"19/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA Y Y LOGISTICA DIAGUI SA DE CV",num_contrato:"MPC/COP/068/FISM-033/2025",monto:1573664.28,presupuesto:972574.55,avance_fisico:73,avance_financiero:100,ejercido:977027.98,disponible:-4453.43},{clave:"P-0027",proyecto:"CONSTRUCCION DE POZOS PLATANAR",estado:"CHIAPAS",municipio:"PICHUCALCO",inicio:"21/10/2025",termino:"19/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA Y Y LOGISTICA DIAGUI SA DE CV",num_contrato:"MPC/COP/068/FISM-034/2025",monto:1641541.64,presupuesto:819996.46,avance_fisico:100,avance_financiero:100,ejercido:819996.45,disponible:0.01},{clave:"P-0074",proyecto:"REHAB. CAMINOS RA. SANTUARIO 1RA. SEC.",estado:"TABASCO",municipio:"JALPA DE MENDEZ",inicio:"17/11/2025",termino:"06/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA Y Y LOGISTICA DIAGUI SA DE CV",num_contrato:"MJM-CONT-DOOTSM-043/2025",monto:597092.98,presupuesto:382664.03,avance_fisico:100,avance_financiero:101,ejercido:386143.08,disponible:-3479.05},{clave:"P-0075",proyecto:"REHAB. CAMINOS RA. CHACALAPA 2DA. SEC.",estado:"TABASCO",municipio:"JALPA DE MENDEZ",inicio:"17/11/2025",termino:"16/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"MATERIALES GONIA SA DE CV",num_contrato:"MJM-CONT-DOOTSM-056/2025",monto:900024.77,presupuesto:591537.19,avance_fisico:100,avance_financiero:96,ejercido:570356.45,disponible:21180.74},{clave:"P-0076",proyecto:"REHAB. CAMINOS TRAMO LA MANGA",estado:"TABASCO",municipio:"JALPA DE MENDEZ",inicio:"17/11/2025",termino:"16/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"SUMSURES DE MEXICO SA DE CV",num_contrato:"MJM-CONT-DOOTSM-057/2025",monto:587009.59,presupuesto:379517.48,avance_fisico:100,avance_financiero:99,ejercido:374752.33,disponible:4765.15},{clave:"P-0077",proyecto:"REHAB. CAMINOS RA. HUAPACAL 2DA. SEC.",estado:"TABASCO",municipio:"JALPA DE MENDEZ",inicio:"20/11/2025",termino:"19/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",num_contrato:"MJM-CONT-DOOTSM-058/2025",monto:1048267.91,presupuesto:688421.12,avance_fisico:100,avance_financiero:100,ejercido:687930.39,disponible:490.73},{clave:"P-0078",proyecto:"REHAB. CAMINOS EJIDO IQUINUAPA",estado:"TABASCO",municipio:"JALPA DE MENDEZ",inicio:"20/11/2025",termino:"19/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"INGENIERIA Y Y LOGISTICA DIAGUI SA DE CV",num_contrato:"MJM-CONT-DOOTSM-059/2025",monto:885738.04,presupuesto:587809.23,avance_fisico:100,avance_financiero:101,ejercido:592399.06,disponible:-4589.83},{clave:"P-0100",proyecto:"TECNOLOGICO DE COMALCALCO",estado:"TABASCO",municipio:"COMALCALCO",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"SUMINISTROS EN PRODUCTOS Y SERVICIOS SAJ SA DE CV",num_contrato:"",monto:546677.16,presupuesto:288942.28,avance_fisico:100,avance_financiero:76,ejercido:218718.63,disponible:70223.65},{clave:"P-0082",proyecto:"REHABILITACION PARQUE EL AMOR",estado:"TABASCO",municipio:"JONUTA",inicio:"17/11/2025",termino:"16/12/2025",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"MATERIALES GONIA SA DE CV",num_contrato:"MJO-DOOTSM-FAISMUN-CONT0095/2025",monto:1541514.09,presupuesto:937500,avance_fisico:90,avance_financiero:100,ejercido:937375.21,disponible:124.79},{clave:"P-0107",proyecto:"SANTIAGO TUXTLA, VERACRUZ",estado:"VERACRUZ",municipio:"SANTIAGO TUXTLA",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"ESTRATEGIAS MAX INNOVA",num_contrato:"",monto:11273811.43,presupuesto:5712650.61,avance_fisico:65,avance_financiero:11,ejercido:615619.45,disponible:5097031.16},{clave:"P-0108",proyecto:"CATEMACO MALECON, VERACRUZ",estado:"VERACRUZ",municipio:"CATEMACO",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"ESTRATEGIAS MAX INNOVA",num_contrato:"",monto:3990747.63,presupuesto:1943812.67,avance_fisico:90,avance_financiero:69,ejercido:1331626.55,disponible:612186.12},{clave:"P-0112",proyecto:"PASO DE OVEJAS, VERACRUZ",estado:"VERACRUZ",municipio:"PASO DE OVEJAS",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"ESTRATEGIAS MAX INNOVA",num_contrato:"",monto:204965.23,presupuesto:105413.72,avance_fisico:0,avance_financiero:20,ejercido:21516.58,disponible:83897.14},{clave:"P-0127",proyecto:"ALUMBRADO PAJAPAN, VERACRUZ",estado:"VERACRUZ",municipio:"PAJAPAN",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"ADMINISTRATIVO",razon_social:"ESTRATEGIAS MAX INNOVA",num_contrato:"",monto:3817306.4,presupuesto:1930368.83,avance_fisico:0,avance_financiero:0,ejercido:0,disponible:1930368.83},{clave:"P-0134",proyecto:"REHAB. DRENAJE SANITARIO TECTUAPAN",estado:"CHIAPAS",municipio:"PICHUCALCO",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"CONTRATISTA",razon_social:"",num_contrato:"MPC/COP/068/FAISMUN-003/2026",monto:855849.79,presupuesto:411885.02,avance_fisico:0,avance_financiero:0,ejercido:1200,disponible:410685.02},{clave:"P-0139",proyecto:"REHAB. DRENAJE SANITARIO, PONCIANO ROJAS",estado:"CHIAPAS",municipio:"PICHUCALCO",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"CONTRATISTA",razon_social:"INGENIERIA Y Y LOGISTICA DIAGUI SA DE CV",num_contrato:"",monto:1279789.53,presupuesto:634997.64,avance_fisico:100,avance_financiero:85,ejercido:541480.13,disponible:93517.51},{clave:"P-0142",proyecto:"AMPLIACION BAJA TENSION AV. 10",estado:"QUINTANA ROO",municipio:"PLAYA DEL CARMEN",inicio:"02/02/2026",termino:"14/02/2026",tipo_ejecucion:"CONTRATISTA",razon_social:"",num_contrato:"",monto:181486.07,presupuesto:102112.3,avance_fisico:0,avance_financiero:98,ejercido:100383.37,disponible:1728.93},{clave:"P-0143",proyecto:"ALUMBRADO CENTRO DE SALUD LDC",estado:"QUINTANA ROO",municipio:"PLAYA DEL CARMEN",inicio:"‚Äî",termino:"‚Äî",tipo_ejecucion:"CONTRATISTA",razon_social:"",num_contrato:"",monto:1006575.28,presupuesto:571190.39,avance_fisico:0,avance_financiero:21,ejercido:121109.86,disponible:450080.53}];

const PROV=[{clave:"PP-0001",proyecto:"DESAZOLVE DE ARROYO EL CRISTO",estado:"CHIAPAS",municipio:"PICHUCALCO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:0},{clave:"PP-0002",proyecto:"DESPENSAS XOCHIMILCO",estado:"CDMX",municipio:"CDMX",razon_social:"GRUPO VENDOX COMERCIAL SA DE CV",monto:5850000,presupuesto:5850000,avance:53,ejercido_suministro:2111941.15},{clave:"PP-0003",proyecto:"DESPENSAS NAUCALPAN",estado:"CDMX",municipio:"CDMX",razon_social:"GRUPO VENDOX COMERCIAL SA DE CV",monto:0,presupuesto:23600000,avance:100,ejercido_suministro:13673085.7},{clave:"PP-0004",proyecto:"H AYUNTAMIENTO TEAPA",estado:"TABASCO",municipio:"TEAPA",razon_social:"",monto:0,presupuesto:0,avance:0,ejercido_suministro:107961.19},{clave:"PP-0005",proyecto:"ARRENDAMIENTO VEHICULAR TEAPA",estado:"TABASCO",municipio:"TEAPA",razon_social:"KUKULKAN ENERGY SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:397936.51},{clave:"PP-0006",proyecto:"ARRENDAMIENTO RETROEXCAVADORA COLIMA",estado:"COLIMA",municipio:"COLIMA",razon_social:"",monto:0,presupuesto:0,avance:0,ejercido_suministro:0},{clave:"PP-0007",proyecto:"ARRENDAMIENTO VEHICULAR PICHUCALCO",estado:"CHIAPAS",municipio:"PICHUCALCO",razon_social:"INGENIERIA Y Y LOGISTICA DIAGUI SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:28023},{clave:"PP-0008",proyecto:"ARRENDAMIENTO VEHICULAR JALAPA",estado:"TABASCO",municipio:"JALAPA",razon_social:"KUKULKAN ENERGY SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:24588},{clave:"PP-0009",proyecto:"CONGRESO DEL ESTADO DE TABASCO",estado:"TABASCO",municipio:"VILLAHERMOSA",razon_social:"MATERIALES GONIA SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:0},{clave:"PP-0010",proyecto:"FRESNILLO ZACATECAS",estado:"ZACATECAS",municipio:"FRESNILLO",razon_social:"KUKULKAN ENERGY SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:0},{clave:"PP-0011",proyecto:"PAPELERIA IEAT",estado:"TABASCO",municipio:"VILLAHERMOSA",razon_social:"",monto:0,presupuesto:0,avance:0,ejercido_suministro:4230.25},{clave:"PP-0012",proyecto:"REHABILITACION DE CAMINO RURAL (CERRO 2)",estado:"CHIAPAS",municipio:"PICHUCALCO",razon_social:"INGENIERIA MEXICANA GAMAN SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:0},{clave:"PP-0013",proyecto:"AYUNTAMIENTO PICHUCALCO",estado:"CHIAPAS",municipio:"PICHUCALCO",razon_social:"",monto:0,presupuesto:0,avance:0,ejercido_suministro:75033.11},{clave:"PP-0014",proyecto:"LEVANTAMIENTOS ZITACUARO",estado:"MICHOACAN",municipio:"ZITACUARO",razon_social:"",monto:0,presupuesto:0,avance:0,ejercido_suministro:0},{clave:"PP-0015",proyecto:"AMBULANCIA IXHUATLAN DEL SURESTE",estado:"VERACRUZ",municipio:"IXHUATL√ÅN DEL SURESTE",razon_social:"",monto:0,presupuesto:1307733.54,avance:0,ejercido_suministro:1307733.54},{clave:"PP-0016",proyecto:"PIPA, PASO DE OVEJA VER.",estado:"VERACRUZ",municipio:"PASO DE OVEJAS",razon_social:"ESTRATEGIAS MAX INNOVA",monto:1920000,presupuesto:1283000,avance:100,ejercido_suministro:1283000},{clave:"PP-0017",proyecto:"AMBULANCIA, CATEMACO VER.",estado:"VERACRUZ",municipio:"CATEMACO",razon_social:"ESTRATEGIAS MAX INNOVA",monto:2327396.03,presupuesto:1340016.92,avance:100,ejercido_suministro:1275450.16},{clave:"PP-0018",proyecto:"COMPACTADOR, PASO DE OVEJAS VER.",estado:"VERACRUZ",municipio:"PASO DE OVEJAS",razon_social:"ESTRATEGIAS MAX INNOVA",monto:2350000,presupuesto:1550000,avance:100,ejercido_suministro:1550000},{clave:"PP-0019",proyecto:"VOLTEO, PASO DE OVEJAS VER.",estado:"VERACRUZ",municipio:"PASO DE OVEJAS",razon_social:"ESTRATEGIAS MAX INNOVA",monto:1950000,presupuesto:1315000,avance:100,ejercido_suministro:1315000},{clave:"PP-0020",proyecto:"AMBULANCIA, CHINAMECA VER.",estado:"VERACRUZ",municipio:"CHINAMECA",razon_social:"ESTRATEGIAS MAX INNOVA",monto:1888094.39,presupuesto:1307734.16,avance:100,ejercido_suministro:1307733.54},{clave:"PP-0021",proyecto:"MODIFICADA AMBULANCIA, XICO",estado:"VERACRUZ",municipio:"XICO",razon_social:"ESTRATEGIAS MAX INNOVA",monto:2960000,presupuesto:1916184.32,avance:100,ejercido_suministro:1307733.54},{clave:"PP-0022",proyecto:"RETROEXCAVADORA, XICO VER.",estado:"VERACRUZ",municipio:"XICO",razon_social:"ESTRATEGIAS MAX INNOVA",monto:3600000,presupuesto:1600000,avance:100,ejercido_suministro:1600000},{clave:"PP-0023",proyecto:"RODILLO, XICO VER.",estado:"VERACRUZ",municipio:"XICO",razon_social:"ESTRATEGIAS MAX INNOVA",monto:4502880,presupuesto:2294000,avance:100,ejercido_suministro:2294000},{clave:"PP-0024",proyecto:"CAMI√ìN COMPACTADOR 21Y, XICO VER.",estado:"VERACRUZ",municipio:"XICO",razon_social:"ESTRATEGIAS MAX INNOVA",monto:0,presupuesto:0,avance:0,ejercido_suministro:3108500},{clave:"PP-0025",proyecto:"ALIMENTOS CENDIS XOCHIMILCO 2026",estado:"CDMX",municipio:"CDMX",razon_social:"COMERCIALIZADORA RIO LIBRE MX SA DE CV",monto:0,presupuesto:0,avance:0,ejercido_suministro:50732},{clave:"PP-0026",proyecto:"CAMI√ìN COMPACTADOR SAYULA",estado:"VERACRUZ",municipio:"SAYULA",razon_social:"ESTRATEGIAS MAX INNOVA",monto:2580000,presupuesto:1720000,avance:100,ejercido_suministro:1720000},{clave:"PP-0027",proyecto:"CAMI√ìN COMPACTADOR TEXISTEPEC",estado:"VERACRUZ",municipio:"TEXISTEPEC",razon_social:"ESTRATEGIAS MAX INNOVA",monto:2580000,presupuesto:1720000,avance:100,ejercido_suministro:1720000},{clave:"PP-0028",proyecto:"CAMI√ìN COMPACTADOR IXHUATL√ÅN",estado:"VERACRUZ",municipio:"IXHUATL√ÅN DEL SURESTE",razon_social:"ESTRATEGIAS MAX INNOVA",monto:2580000,presupuesto:1720000,avance:100,ejercido_suministro:1720000},{clave:"PP-0029",proyecto:"CAMI√ìN COMPACTADOR COTAXTLA",estado:"VERACRUZ",municipio:"COTAXTLA",razon_social:"ESTRATEGIAS MAX INNOVA",monto:2580000,presupuesto:1720000,avance:100,ejercido_suministro:1720000},{clave:"PP-0030",proyecto:"14 YARDAS COMPACTADOR AYAHULULCO",estado:"VERACRUZ",municipio:"AYAHUALULCO",razon_social:"",monto:2380000,presupuesto:1438000,avance:100,ejercido_suministro:1438000},{clave:"PP-0031",proyecto:"14 YARDAS COMPACTADOR RAFAEL LUCIO",estado:"VERACRUZ",municipio:"RAFAEL LUCIO",razon_social:"",monto:2380000,presupuesto:1438000,avance:100,ejercido_suministro:1156000},{clave:"PP-0032",proyecto:"14 YARDAS COMPACTADOR ACAJETE",estado:"VERACRUZ",municipio:"CAJEME",razon_social:"",monto:2380000,presupuesto:1438000,avance:100,ejercido_suministro:1438000},{clave:"PP-0033",proyecto:"14 YARDAS COMPACTADOR YECAUTLA",estado:"VERACRUZ",municipio:"YECAUTLA",razon_social:"",monto:2380000,presupuesto:1438000,avance:100,ejercido_suministro:1438000},{clave:"PP-0034",proyecto:"21 YARDAS COMPACTADOR BANDERILLA",estado:"VERACRUZ",municipio:"BANDERILLA",razon_social:"",monto:2580000,presupuesto:1720000,avance:100,ejercido_suministro:1720000},{clave:"PP-0035",proyecto:"21 YARDAS COMPACTADOR IXHUATLAN DEL CAFE",estado:"VERACRUZ",municipio:"IXHUATLAN DEL CAFE",razon_social:"",monto:2580000,presupuesto:1720000,avance:100,ejercido_suministro:1720000},{clave:"PP-0036",proyecto:"21 YARDAS COMPACTADOR COSAUTLAN",estado:"VERACRUZ",municipio:"COSAULTLAN",razon_social:"",monto:2580000,presupuesto:1720000,avance:100,ejercido_suministro:1720000}];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê UTILS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const fm  = n => !n ? '‚Äî' : '$'+n.toLocaleString('es-MX',{maximumFractionDigits:0});
const fmM = n => { if(!n) return '‚Äî'; const m=n/1e6; return m>=1?'$'+m.toFixed(1)+'M':'$'+n.toLocaleString('es-MX',{maximumFractionDigits:0}); };
const ac  = v => v>100?'#6a5a98':v>=75?'#3d8a70':v>=25?'#b8903a':'#c0505a';
const grp = (arr,key) => arr.reduce((m,r)=>{ (m[r[key]]=m[r[key]]||[]).push(r); return m; },{});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê KPIs ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function initKPIs(){
  const pob=OBRAS.reduce((a,r)=>a+r.presupuesto,0), eob=OBRAS.reduce((a,r)=>a+r.ejercido,0);
  const ppv=PROV.reduce((a,r)=>a+r.presupuesto,0),  epv=PROV.reduce((a,r)=>a+r.ejercido_suministro,0);
  document.getElementById('k-pob').textContent   = fmM(pob);
  document.getElementById('k-pob-s').textContent = 'Ejercido: '+fmM(eob);
  document.getElementById('k-ppv').textContent   = fmM(ppv);
  document.getElementById('k-ppv-s').textContent = 'Ejercido: '+fmM(epv);
  document.getElementById('ob-ej').textContent   = fmM(eob);
  document.getElementById('pv-ej').textContent   = fmM(epv);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SELECTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function initSelects(){
  const fill = (id, data) => {
    const sel = document.getElementById(id);
    [...new Set(data.map(r=>r.estado))].sort().forEach(s=>{
      const o=document.createElement('option'); o.value=s; o.textContent=s; sel.appendChild(o);
    });
  };
  fill('sel-ob', OBRAS);
  fill('sel-pv', PROV);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RENDER GROUPS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function makeRow(r, tipo){
  const av   = tipo==='obra' ? r.avance_financiero : r.avance;
  const over = av > 100;
  const div  = document.createElement('div');
  div.className = `p-row ${tipo==='obra'?'ro':'rp'}`;
  div.innerHTML = `
    <div class="c-id">${r.clave}</div>
    <div class="c-name">${r.proyecto}
      <div class="sub">${r.razon_social||'Sin contratista registrado'}</div>
    </div>
    <div class="c-amt">${fm(tipo==='obra'?r.monto:r.presupuesto)}</div>
    <div class="c-av">
      <div class="av-n" style="color:${ac(av)}">${av>0?av+'%':'‚Äî'}</div>
      <div class="pb"><div class="pf${over?' over':''}" style="width:${Math.min(av,100)}%"></div></div>
    </div>
    <div class="c-tp">${r.tipo_ejecucion?r.tipo_ejecucion.substring(0,5)+'.':''}</div>`;
  div.onclick = () => tipo==='obra' ? omO(r) : omP(r);
  return div;
}

function renderGroups(containerId, data, tipo){
  const q  = document.getElementById(tipo==='obra'?'srch-ob':'srch-pv').value.toLowerCase();
  const st = document.getElementById(tipo==='obra'?'sel-ob':'sel-pv').value;
  const filtered = data.filter(r=>{
    const mq = !q || [r.proyecto,r.municipio,r.estado,r.razon_social||'',r.clave].some(x=>x.toLowerCase().includes(q));
    const ms = !st || r.estado===st;
    return mq && ms;
  });
  const byState = grp(filtered,'estado');
  const cont    = document.getElementById(containerId);
  cont.innerHTML = '';

  if(!filtered.length){
    cont.innerHTML='<div style="padding:32px;text-align:center;color:var(--txt3);font-size:14px;">Sin resultados para esta b√∫squeda</div>';
    return;
  }

  Object.keys(byState).sort().forEach((estado,si)=>{
    const stProjs = byState[estado];
    const byMun   = grp(stProjs,'municipio');
    const totPres = stProjs.reduce((a,r)=>a+(tipo==='obra'?r.presupuesto:r.presupuesto),0);
    const totEj   = stProjs.reduce((a,r)=>a+(tipo==='obra'?r.ejercido:r.ejercido_suministro),0);

    const sg = document.createElement('div');
    sg.className = 'state-group';
    sg.style.animationDelay = (si*0.04)+'s';
    sg.innerHTML = `
      <div class="sg-head" onclick="toggleSG(this)">
        <div class="sg-head-l">
          <span class="sg-chevron open">‚ñ∂</span>
          <span class="sg-estado">${estado}</span>
          <span class="sg-badge ${tipo==='obra'?'o':'p'}">${stProjs.length} proy.</span>
          <span class="sg-badge ${tipo==='obra'?'o':'p'}">${Object.keys(byMun).length} mun.</span>
        </div>
        <div class="sg-stats">
          <div class="sg-stat">
            <div class="sg-stat-lbl">Presupuesto</div>
            <div class="sg-stat-val ${tipo==='obra'?'o':'p'}">${fmM(totPres)}</div>
          </div>
          <div class="sg-stat">
            <div class="sg-stat-lbl">Ejercido</div>
            <div class="sg-stat-val ${tipo==='obra'?'o':'p'}">${fmM(totEj)}</div>
          </div>
        </div>
      </div>
      <div class="sg-body open"></div>`;

    const body = sg.querySelector('.sg-body');
    const th = document.createElement('div');
    th.className = 't-head';
    th.innerHTML = '<div>CLAVE</div><div>PROYECTO / CONTRATISTA</div><div style="text-align:right">MONTO</div><div style="text-align:right">AVANCE</div><div style="text-align:right">TIPO</div>';
    body.appendChild(th);

    Object.keys(byMun).sort().forEach((mun,mi)=>{
      const munP = byMun[mun];
      const mg   = document.createElement('div');
      mg.className = 'mun-group';
      mg.innerHTML = `
        <div class="mg-head" onclick="toggleMG(this)">
          <div class="mg-left">
            <span class="mg-chevron open">‚ñ∂</span>
            <span class="mg-name">üìç ${mun}</span>
          </div>
          <span class="mg-count">${munP.length} proyecto${munP.length>1?'s':''}</span>
        </div>
        <div class="mg-body open"></div>`;
      const mb = mg.querySelector('.mg-body');
      munP.forEach(r => mb.appendChild(makeRow(r, tipo)));
      body.appendChild(mg);
    });
    cont.appendChild(sg);
  });

  document.getElementById(tipo==='obra'?'ob-cnt':'pv-cnt').textContent =
    filtered.length+' de '+(tipo==='obra'?OBRAS:PROV).length+' proyectos';
}

function renderObras(){ renderGroups('ob-groups', OBRAS, 'obra'); }
function renderProv() { renderGroups('pv-groups', PROV,  'prov'); }

function toggleSG(h){ h.nextElementSibling.classList.toggle('open'); h.querySelector('.sg-chevron').classList.toggle('open'); }
function toggleMG(h){ h.nextElementSibling.classList.toggle('open'); h.querySelector('.mg-chevron').classList.toggle('open'); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ANALYTICS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function buildStateChart(){
  const m={};
  OBRAS.forEach(r=>{ if(!m[r.estado])m[r.estado]={o:0,p:0}; m[r.estado].o++; });
  PROV.forEach(r=>{  if(!m[r.estado])m[r.estado]={o:0,p:0}; m[r.estado].p++; });
  const sorted = Object.entries(m).sort((a,b)=>(b[1].o+b[1].p)-(a[1].o+a[1].p)).slice(0,8);
  const mx = Math.max(...sorted.map(([,v])=>v.o+v.p));
  document.getElementById('s-list').innerHTML = sorted.map(([e,v])=>`
    <div class="s-row">
      <div class="s-name">${e}</div>
      <div class="s-bars">
        <div class="s-bw" style="height:5px"><div class="s-bf-o" style="width:${v.o/mx*100}%"></div></div>
        <div class="s-bw" style="height:5px"><div class="s-bf-p" style="width:${v.p/mx*100}%"></div></div>
      </div>
      <div class="s-cnt">O:${v.o} ¬∑ P:${v.p}</div>
    </div>`).join('');
}

function buildAvanceDist(){
  const bk = data => ({
    s: data.filter(v=>v<=0).length,
    b: data.filter(v=>v>0&&v<25).length,
    m: data.filter(v=>v>=25&&v<75).length,
    a: data.filter(v=>v>=75&&v<100).length,
    c: data.filter(v=>v>=100).length
  });
  const ob = bk(OBRAS.map(r=>r.avance_financiero));
  const pv = bk(PROV.map(r=>r.avance));
  const cs = [['s','#C2C8C5'],['b','#c0505a'],['m','#b8903a'],['a','#3d8a70'],['c','#4A707A']];

  const seg = (id,b) => document.getElementById(id).innerHTML =
    cs.map(([k,c])=>b[k]?`<div class="seg" style="flex:${b[k]};background:${c}"></div>`:'').join('');
  seg('seg-ob',ob); seg('seg-pv',pv);

  const leg = (id,b) => document.getElementById(id).innerHTML = `
    <div class="al"><div class="ad" style="background:#C2C8C5"></div>Sin dato: ${b.s}</div>
    <div class="al"><div class="ad" style="background:#c0505a"></div>&lt;25%: ${b.b}</div>
    <div class="al"><div class="ad" style="background:#b8903a"></div>25-74%: ${b.m}</div>
    <div class="al"><div class="ad" style="background:#3d8a70"></div>75-99%: ${b.a}</div>
    <div class="al"><div class="ad" style="background:#4A707A"></div>‚â•100%: ${b.c}</div>`;
  leg('leg-ob',ob); leg('leg-pv',pv);

  const avO = OBRAS.length ? Math.round(OBRAS.reduce((a,r)=>a+r.avance_financiero,0)/OBRAS.length) : 0;
  const avP = PROV.filter(r=>r.avance>0).length ? Math.round(PROV.filter(r=>r.avance>0).reduce((a,r)=>a+r.avance,0)/PROV.filter(r=>r.avance>0).length) : 0;
  document.getElementById('av-stats').innerHTML = `
    <div class="av-s"><div class="av-sv" style="color:var(--obra)">${avO}%</div><div class="av-sl">Prom. Obra</div></div>
    <div class="av-s"><div class="av-sv" style="color:var(--prov)">${avP}%</div><div class="av-sl">Prom. Prov.</div></div>
    <div class="av-s"><div class="av-sv" style="color:#3d8a70">${ob.c}</div><div class="av-sl">Obras ‚â•100%</div></div>
    <div class="av-s"><div class="av-sv" style="color:#3d8a70">${pv.c}</div><div class="av-sl">Prov. ‚â•100%</div></div>`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODALS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function omO(r){
  document.getElementById('mt').textContent = r.proyecto;
  document.getElementById('mc').textContent = r.clave+' ¬∑ '+r.estado+' ‚Äî '+r.municipio+' ¬∑ '+r.tipo_ejecucion;
  document.getElementById('mb').innerHTML = `
    <div class="d-grid">
      <div class="d-item"><label>Raz√≥n Social</label><value>${r.razon_social||'‚Äî'}</value></div>
      <div class="d-item"><label>No. Contrato</label><value style="font-size:11px">${r.num_contrato||'‚Äî'}</value></div>
      <div class="d-item"><label>Fecha Inicio</label><value>${r.inicio}</value></div>
      <div class="d-item"><label>Fecha T√©rmino</label><value>${r.termino}</value></div>
      <div class="d-item"><label>Avance F√≠sico</label><value style="color:${ac(r.avance_fisico)};font-size:18px">${r.avance_fisico}%</value></div>
      <div class="d-item"><label>Avance Financiero</label><value style="color:${ac(r.avance_financiero)};font-size:18px">${r.avance_financiero}%</value></div>
    </div>
    <div class="d-sec">Desglose Financiero</div>
    <div class="b-row"><span class="bl">Monto de Contrato</span><span class="bv">${fm(r.monto)}</span></div>
    <div class="b-row"><span class="bl">Presupuesto Autorizado</span><span class="bv">${fm(r.presupuesto)}</span></div>
    <div class="b-row"><span class="bl">Total Ejercido</span><span class="bv">${fm(r.ejercido)}</span></div>
    <div class="b-row"><span class="bl">Saldo Disponible</span><span class="bv ${r.disponible<0?'neg':'pos'}">${fm(r.disponible)}</span></div>`;
  document.getElementById('mov').classList.add('open');
}
function omP(r){
  document.getElementById('mt').textContent = r.proyecto;
  document.getElementById('mc').textContent = r.clave+' ¬∑ '+r.estado+' ‚Äî '+r.municipio;
  document.getElementById('mb').innerHTML = `
    <div class="d-grid">
      <div class="d-item"><label>Proveedor</label><value>${r.razon_social||'‚Äî'}</value></div>
      <div class="d-item"><label>Estado</label><value>${r.estado}</value></div>
      <div class="d-item"><label>Municipio</label><value>${r.municipio}</value></div>
      <div class="d-item"><label>Avance Ejecutado</label><value style="color:${ac(r.avance)};font-size:18px">${r.avance>0?r.avance+'%':'Sin registro'}</value></div>
    </div>
    <div class="d-sec">Desglose Financiero</div>
    <div class="b-row"><span class="bl">Monto Contrato</span><span class="bv">${fm(r.monto)}</span></div>
    <div class="b-row"><span class="bl">Presupuesto</span><span class="bv">${fm(r.presupuesto)}</span></div>
    <div class="b-row"><span class="bl">Ejercido en Suministro</span><span class="bv">${fm(r.ejercido_suministro)}</span></div>`;
  document.getElementById('mov').classList.add('open');
}
function cm(){ document.getElementById('mov').classList.remove('open'); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const now = new Date();
document.getElementById('live-date').innerHTML =
  now.toLocaleDateString('es-MX',{weekday:'long'}).toUpperCase()+'<br>'+
  now.toLocaleDateString('es-MX',{year:'numeric',month:'long',day:'numeric'});
initKPIs();
initSelects();
renderObras();
renderProv();
buildStateChart();
buildAvanceDist();
</script>
</body>
</html>
